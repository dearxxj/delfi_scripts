print(1)
library(BSgenome.Hsapiens.UCSC.hg19)
library(rtracklayer)
library(tidyverse)
library(httr)
library(GenomicAlignments)
library(GenomicRanges)
library(getopt)
library(Homo.sapiens)
library(biovizBase)
library(RCurl)
library(readxl)
library(multidplyr)
setwd('~/Documents/projects/delfi_scripts')
outprefix <- "NA12878"
outdir <- '../'
frag.file <- file.path(outdir, paste0(outprefix, "_frags.rds"))
gc.correct <- function(coverage, bias) {
i <- seq(min(bias, na.rm=TRUE), max(bias, na.rm=TRUE), by = 0.001)
coverage.trend <- loess(coverage ~ bias)
coverage.model <- loess(predict(coverage.trend, i) ~ i)
coverage.pred <- predict(coverage.model, bias)
coverage.corrected <- coverage - coverage.pred + median(coverage)
}
filename <- file.path(outdir, paste0(outprefix, "_bin_100kb.rds"))
if(file.exists(filename)) q('no')
